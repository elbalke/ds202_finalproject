---
title: "DS 202 Final Project Q6&7"
author: "Patrick Wenzel"
date: "11/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(stringr)
library(dplyr)
library(lubridate)
library(tidyverse)
library(readxl)
library(expss)
library(ggrepel)
bidenTweets <- read.csv("JoeBidenTweets.csv")
trumpTweets <- read.csv("realdonaldtrump.csv")
```

## 6.Who has more retweets and favorites for their tweets?
```{r}
bidenGroup <- bidenTweets %>% summarise(
                          BidenTotalRetweets = sum(bidenTweets$retweets),
                          BidenTotalFavorites = sum(likes),
                          BidenAverageRetweets = mean(retweets),
                          BidenAverageFavorites = mean(likes),
                          BidenNumTweets = n())
trumpGroup <- trumpTweets %>% summarise(
                          TrumpTotalRetweets = sum(retweets),
                          TrumpTotalFavorites = sum(favorites),
                          TrumpAverageRetweets = mean(retweets),
                          TrumpAverageFavorites = mean(favorites),
                          TrumpNumTweets = n()
)
name <- c('Trump', 'Biden')
totalRetweets <- c(trumpGroup$TrumpTotalRetweets, bidenGroup$BidenTotalRetweets)
totalFavorites <- c(trumpGroup$TrumpTotalFavorites, bidenGroup$BidenTotalFavorites)
averageRetweets <- c(trumpGroup$TrumpAverageRetweets, bidenGroup$BidenAverageRetweets)
averageFavorites <- c(trumpGroup$TrumpAverageFavorites, bidenGroup$BidenAverageFavorites)
numberOfTweets <- c(trumpGroup$TrumpNumTweets, bidenGroup$BidenNumTweets)
candidatesTweetData <- data.frame(name, totalRetweets, totalFavorites, averageRetweets, averageFavorites, numberOfTweets)
ggplot(candidatesTweetData, aes(x = name, y = totalRetweets)) + geom_bar(stat="identity") + ggtitle('Total Number of Retweets per Candidate') + xlab('Candidate') + ylab('Total Number of Retweets')
ggplot(candidatesTweetData, aes(x = name, y = totalFavorites)) + geom_bar(stat="identity") + ggtitle('Total Number of Favorites per Candidate') + xlab('Candidate') + ylab('Total Number of Favorites')
ggplot(candidatesTweetData, aes(x = name, y = averageRetweets)) + geom_bar(stat="identity") + ggtitle('Average Number of Retweets per Candidate') + xlab('Candidate') + ylab('Average Number of Retweets')
ggplot(candidatesTweetData, aes(x = name, y = averageFavorites)) + geom_bar(stat="identity") + ggtitle('Average Number of Retweets per Candidate') + xlab('Candidate') + ylab('Average Number of Favorites')
candidatesTweetData
```

    Based on this data and the graphs, Trump has a significant more amount of retweets and favorites than Biden. However, Trump also has 37,576 more tweets than Biden. We looked into when the data sets were most recently updated and what date range the tweets were collected. The dataset we used for Trump's tweets had tweets from May 4th, 2009 through June 30th, 2020. There are 9 total years in this dataset. The dataset we used for Biden's tweets had tweets from April 9th, 2012 through April 30th, 2020 along with two tweets from 2007. There are 9 total years in this dataset. Although Trump's dataset started earlier, most of the tweets were from 2011 on and since Trump tweets an average of 3,612.67 times a year and Biden tweets an average of 641.78 times a year, I don't think having another year of Biden's tweets would make a big enough of a difference to get the counts closer to each other. Below will be an analyses of the average tweets per year each candidate tweeted. Although Trump has tweeted many more times, he barely has more average retweets per tweet than Biden and Biden actually has more average favorites than Trump.

## 7.What are the common hashtags used between Biden and Trump?

```{r}
trumpHashtags <- unlist(strsplit(trumpTweets$hashtags, ','))
trumpHashtags <- tibble(trumpHashtags)
trumpHashtags <- unique(trumpHashtags$trumpHashtags)
trumpHashtags <- tibble(trumpHashtags)

bidenHashtags <- unlist(strsplit(bidenTweets$hashtags, ','))
bidenHashtags <- tibble(bidenHashtags)
bidenHashtags <- unique(bidenHashtags$bidenHashtags)
bidenHashtags <- tibble(bidenHashtags)
hashtagJoin <- inner_join(trumpHashtags, bidenHashtags, by = c('trumpHashtags' = 'bidenHashtags'))
colnames(hashtagJoin) <- c('hashtag')
print(as_tibble(hashtagJoin), n = 29)
```

    Based off of these findings, it seems like the majority of commonalities between the two candidates' hashtag usage is that most of them seem to either be a holiday, a day celebrating a person or group of people, standing in solidarity after a tragedy (for example #VegasStrong), or an election. 